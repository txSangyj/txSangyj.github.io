<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://txSangyj.github.io/</id>
    <title>ji</title>
    <updated>2021-03-03T15:28:41.907Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://txSangyj.github.io/"/>
    <link rel="self" href="https://txSangyj.github.io/atom.xml"/>
    <subtitle>å­¦ä¹ ç”¨</subtitle>
    <logo>https://txSangyj.github.io/images/avatar.png</logo>
    <icon>https://txSangyj.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, ji</rights>
    <entry>
        <title type="html"><![CDATA[2021ä¹¦å•]]></title>
        <id>https://txSangyj.github.io/post/2021-shu-dan/</id>
        <link href="https://txSangyj.github.io/post/2021-shu-dan/">
        </link>
        <updated>2021-03-03T14:53:31.000Z</updated>
        <summary type="html"><![CDATA[<p>éƒ½ä¸‰æœˆäº†ï¼Œä¹¦çœ‹äº†å‡ æœ¬ï¼Ÿ</p>
]]></summary>
        <content type="html"><![CDATA[<p>éƒ½ä¸‰æœˆäº†ï¼Œä¹¦çœ‹äº†å‡ æœ¬ï¼Ÿ</p>
<!-- more -->
<h2 id="å·²">å·²ï¼š</h2>
<pre><code>ã€Šå¨±ä¹è‡³æ­»ã€‹ï¼šåƒçœ‹ä¸€ç¯‡è®ºæ–‡ã€‚ä¸çœ‹æŠ–éŸ³ï¼Œçœ‹å®Œå¾®åšéƒ½æƒ³å¸äº†ã€‚åº”è¯¥æ§åˆ¶ä¸€ä¸‹è·å–æ— ç”¨ä¿¡æ¯çš„é¢‘ç‡äº†ã€‚
</code></pre>
<h2 id="åœ¨">åœ¨ï¼š</h2>
<pre><code>ã€Šæ²™ä¸˜ã€‹ï¼šè¯»è¯‘æ–‡çœŸæ˜¯ç—›è‹¦ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½åšæŒè¯»å®Œã€‚
ã€Šå°ç‹—é’±é’±ã€‹ï¼š
    1. å°ç›®æ ‡ï¼Œå¼€å®¶å°ä¹¦åº—è¦å¤šå°‘é’±ï¼Ÿ
    2. å…»é¹…ğŸ§
    3. â€œ  è¿™çœŸçš„æœ‰å¿…è¦å—â€
    4. å‘¨å››è®°è´¦
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[aarch64ä¸‹ç¼–è¯‘libtorch]]></title>
        <id>https://txSangyj.github.io/post/armv8-bian-yi-libtorch/</id>
        <link href="https://txSangyj.github.io/post/armv8-bian-yi-libtorch/">
        </link>
        <updated>2019-08-15T02:32:27.000Z</updated>
        <summary type="html"><![CDATA[<p>æŠŠå†™çš„libtorchè°ƒç”¨æ¨¡å‹çš„ç¨‹åºç§»æ¤åˆ°äº†ä¸‹Ubuntuä¸‹å‘ç°æ²¡æœ‰é—®é¢˜ï¼Œlibtorchæä¾›äº†é¢„ç¼–è¯‘å¥½çš„åº“ã€‚æ”¾åˆ°åŸºäºArmçš„å›½äº§ä¸»æœºä¸Šå°±æç¤ºlibtorch.soä¸æ˜¯åŠ¨æ€åº“æ–‡ä»¶ï¼Œéœ€è¦ä»æºä»£ç ç¼–è¯‘libtorchã€‚ä¸è¿‡æ²¡å•¥éš¾ç‚¹ï¼Œè¸©å‘æ–‡ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æŠŠå†™çš„libtorchè°ƒç”¨æ¨¡å‹çš„ç¨‹åºç§»æ¤åˆ°äº†ä¸‹Ubuntuä¸‹å‘ç°æ²¡æœ‰é—®é¢˜ï¼Œlibtorchæä¾›äº†é¢„ç¼–è¯‘å¥½çš„åº“ã€‚æ”¾åˆ°åŸºäºArmçš„å›½äº§ä¸»æœºä¸Šå°±æç¤ºlibtorch.soä¸æ˜¯åŠ¨æ€åº“æ–‡ä»¶ï¼Œéœ€è¦ä»æºä»£ç ç¼–è¯‘libtorchã€‚ä¸è¿‡æ²¡å•¥éš¾ç‚¹ï¼Œè¸©å‘æ–‡ã€‚</p>
<!-- more -->
<h1 id="è·å–æºç ">è·å–æºç </h1>
<pre><code class="language-bash">
git clone https://github.com/pytorch/pytorch --recursive &amp;&amp; cd pytorch
git checkout v1.2.0 # çœŸçš„å‹‡å£«æ•¢äºåœ¨masteråˆ†æ”¯ä¸‹ç¼–è¯‘
#ä¸‹è½½ç¼–è¯‘éœ€è¦çš„å­æ¨¡å—
git submodule sync
git submodule update --init --recursive
</code></pre>
<h1 id="pythonç¯å¢ƒ">pythonç¯å¢ƒ</h1>
<p>pytorchå®˜æ–¹ç»™å‡ºçš„ç¯å¢ƒæ˜¯ç”¨condaè£…çš„ï¼Œç„¶è€Œæ‚²å‰§çš„æ˜¯å®˜æ–¹å¹¶æ²¡æœ‰ç»™å‡ºaarch64çš„å®‰è£…æ–‡ä»¶ï¼Œæ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨pipæ¥å®‰è£…ã€‚è¿˜æœ‰ä¸ªé—®é¢˜æ˜¯å¾ˆå¤špythonåº“å¹¶æ²¡æœ‰å‘å¸ƒå¯¹åº”æ¶æ„ä¸‹çš„åŒ…ï¼Œå¥½åœ¨ç¼–è¯‘libtorchéœ€è¦çš„pythonç¯å¢ƒè¾ƒä¸ºç®€å•ã€‚ç¼–è¯‘å®Œä¹‹åå¯¼å‡ºpythonç¯å¢ƒå‘ç°ï¼Œç¼–è¯‘libtorchå¿…é¡»çš„åŒ…åº”è¯¥åªæœ‰pyyamlï¼ˆä¸å¤ªç¡®å®šï¼‰ã€‚å½“ç„¶cmakeå’Œgccç­‰å·¥å…·è¿˜æ˜¯å¿…é¡»çš„ã€‚<br>
å®‰è£…pyyamlçš„å‘½ä»¤ï¼š</p>
<pre><code>pip install pyyaml
</code></pre>
<blockquote>
<p>ä¸ä½¿ç”¨toolsä¸‹çš„è„šæœ¬è€Œç›´æ¥ç”¨cmakeæ¥ç¼–è¯‘çš„è¯å¯èƒ½pythonç¯å¢ƒéƒ½ä¸éœ€è¦äº†...</p>
</blockquote>
<h1 id="ç¼–è¯‘libtorch">ç¼–è¯‘libtorch</h1>
<p>åœ¨ç¼–è¯‘ä¹‹å‰å¯ä»¥ä½¿ç”¨exportæˆ–è€…cmake-guiå…³é—­ä¸€äº›ä¸å¿…è¦çš„ç¼–è¯‘é€‰é¡¹æ¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼Œç±»ä¼¼ï¼š</p>
<pre><code>export USE_CUDA=False
export BUILD_TEST=False
</code></pre>
<p>å®˜æ–¹æä¾›äº†ä¸€é”®å¼ç¼–è¯‘å·¥å…·ï¼Œåœ¨pytorch/tools/build_libtorch.pyã€‚åªéœ€è¦è¿è¡Œï¼š</p>
<pre><code class="language-bash">
#pytorch$
mkdir build &amp;&amp; cd build
python ../tools/build_libtorch.py
</code></pre>
<p>å°±ä¼šåœ¨buildä¸‹ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦çš„åŠ¨æ€åº“æ–‡ä»¶libtorch.soåœ¨build/lib/ä¸‹ã€‚</p>
<h1 id="æ•´ç†libtorch">æ•´ç†libtorch</h1>
<ol>
<li>å¤åˆ¶pytorchä¸‹torchã€caffe2ã€c10ä»¥åŠaten\sourceä¸‹çš„ATenã€THç­‰æ–‡ä»¶å¤¹åˆ°libtorch/includeä¸‹ï¼Œå¾—åˆ°libtorchçš„C++æ¥å£ã€‚</li>
<li>å¤åˆ¶build/libä¸‹ç¼–è¯‘å¥½çš„åº“æ–‡ä»¶åˆ°libtorch/libä¸‹ã€‚</li>
<li>å¤åˆ¶pytorch/torch/share/cmakeæ–‡ä»¶å¤¹åˆ°libtorch/shareä¸‹ã€‚<br>
å¾—åˆ°çš„libtorchä¸»è¦ç»“æ„ï¼š<br>
libtorch.<br>
â”œâ”€include<br>
â”‚  â”œâ”€ATen<br>
â”‚  â”œâ”€c10<br>
â”‚  â”œâ”€caffe2<br>
â”‚  â”œâ”€TH<br>
â”‚  â”œâ”€THCUNN<br>
â”‚  â”œâ”€THNN<br>
â”‚  â””â”€torch<br>
â”œâ”€lib<br>
â””â”€share<br>
â””â”€cmake<br>
â”œâ”€ATen<br>
â”œâ”€Caffe2<br>
â”œâ”€Gloo<br>
â””â”€Torch</li>
</ol>
<hr>
<p>å¦‚æœä½ éœ€è¦pytorchç¼–è¯‘å¯ä»¥å‚è€ƒä¸€ä¸‹<a href="https://nmilosev.svbtle.com/compling-arm-stuff-without-an-arm-board-build-pytorch-for-the-raspberry-pi">è¿™ç¯‡</a><br>
psï¼šè¿˜æ˜¯å¯¹CMakeListsä¸å¤ªç†Ÿå•Šã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[torch/libtorch å¤šè¾“å…¥]]></title>
        <id>https://txSangyj.github.io/post/torchlibtorch-duo-shu-ru/</id>
        <link href="https://txSangyj.github.io/post/torchlibtorch-duo-shu-ru/">
        </link>
        <updated>2019-08-07T02:40:33.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
ä¸€ä¸ªå°å‘ï¼Œå¤šè¾“å…¥çš„pytorchæ¨¡å‹åœ¨å¯¼å‡ºptæ–‡ä»¶ä¾›libtorchè°ƒç”¨æ—¶å€™ï¼Œpythonä¸‹æ¨¡å‹çš„forwardæ–¹æ³•ä¸èƒ½ä½¿ç”¨tupleçš„å½¢å¼ä¼ å…¥inputsã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#pytorch%E4%B8%8B">pytorchä¸‹</a>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E8%BE%93%E5%85%A5">æ•°æ®è¾“å…¥</a></li>
</ul>
</li>
<li><a href="#libtorch%E4%B8%8B">libtorchä¸‹</a></li>
</ul>
<br>
ä¸€ä¸ªå°å‘ï¼Œå¤šè¾“å…¥çš„pytorchæ¨¡å‹åœ¨å¯¼å‡ºptæ–‡ä»¶ä¾›libtorchè°ƒç”¨æ—¶å€™ï¼Œpythonä¸‹æ¨¡å‹çš„forwardæ–¹æ³•ä¸èƒ½ä½¿ç”¨tupleçš„å½¢å¼ä¼ å…¥inputsã€‚</p>
<!-- more -->
<h1 id="pytorchä¸‹">pytorchä¸‹</h1>
<p>pytorchä¸‹å¤šè¾“å…¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œä¿®æ”¹æ¨¡å‹çš„forwardæ–¹æ³•å°±å¯ä»¥ã€‚</p>
<h2 id="æ•°æ®è¾“å…¥">æ•°æ®è¾“å…¥</h2>
<p>åœ¨å¤„ç†å›¾ç‰‡æ—¶ç»å¸¸éœ€è¦å¤šè¾“å…¥ï¼Œæ¯”å¦‚åˆ†ç±»æ—¶è¾“å…¥é¢å¤–ç‰¹å¾ã€æ£€æµ‹æ—¶è¾“å…¥å®šç•Œæ¡†ï¼Œè€Œpytorchå·²ç»å®ç°äº†åŸºæœ¬çš„Datasetç±»ï¼Œå®ç°å¤šè¾“å…¥ä½¿ç”¨çš„å°±æ˜¯æ´¾ç”Ÿä¸€ä¸ªè‡ªå®šä¹‰çš„Datasetç„¶åå®ç°æ•°æ®è¯»å–ä»¥åŠ__getitem__ã€__len__æ–¹æ³•ä¾›Dataloaderè°ƒç”¨ã€‚</p>
<p>ä¸‹é¢æ˜¯è‡ªå·±ç”¨åˆ°çš„ä»£ç ï¼Œè‡ªå®šä¹‰è¿˜æ˜¯æ¯”è¾ƒç®€å•ã€‚</p>
<pre><code class="language-python">
import os
import numpy as np
from torch.utils.data import DataLoader,Dataset
from torchvision.datasets.folder import default_loader


class CustomDataset(Dataset):
    def __init__(self,
                 img_path,
                 txt_path,
                 loader = default_loader,
                 img_transform=None,
                 ):
        with open(txt_path, 'r') as f:
            lines = f.readlines()
            self.imgs = [
                os.path.join(img_path, i.split(',')[0].partition('\\')[2]) for i in lines
            ]
            self.label_list = [i.split('\\')[1] for i in lines]
            self.feature_list = np.array([list(map(float,[i.split(',')[1],i.split(',')[2],
                                            i.split(',')[3],i.split(',')[4],
                                            i.split(',')[5],i.split(',')[6]]))
                                 for i in lines])
        self.feature_list[:,2:] = self.feature_list[:,2:] / 28
        self.img_transform = img_transform
        self.loader = loader
        self.labels = list(set(self.label_list))
        self.labels.sort()
        self.class_to_idx = dict(zip(self.labels ,range(len(self.labels))))
        self.label_list = [self.class_to_idx[c] for c in self.label_list]

    def __getitem__(self, index):
        img_path = self.imgs[index]
        extra_feature = self.feature_list[index]
        label = self.label_list[index]
        img = self.loader(img_path)
        if self.img_transform is not None:
            img = self.img_transform(img)
        return img, extra_feature, label

    def __len__(self):
        return len(self.label_list)

</code></pre>
<h1 id="libtorchä¸‹">libtorchä¸‹</h1>
<p>libtorchä¸‹æ¨¡å‹çš„forwardæ–¹æ³•çš„è¾“å…¥æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå¦‚æœæ¨¡å‹çš„forwardæ–¹æ³•æ¯ä¸ªå‚æ•°å¯¹åº”ä¸€ä¸ªè¾“å…¥çš„è¯ï¼Œåœ¨å¯¹åº”ä½ç½®è¾“å…¥å°±æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœpythonæ¨¡å‹ä½¿ç”¨äº†tupleæ¥ä¼ inputsï¼Œé‚£å¯èƒ½é‡åˆ°ä¸‹é¢å‡ ç§å‚æ•°ä¸åŒ¹é…çš„é”™è¯¯ï¼Œåœ¨libtorchä¸­è°ƒç”¨æ¨¡å‹çš„forwardæ—¶æ— æ³•å°†è¾“å…¥çš„std::vector&lt;torch::IValue&gt;è½¬æ¢ä¸º(Tensor, Tensor)ã€‚</p>
<pre><code>Expected value of type (Tensor, Tensor) for argument 'argument_1' in position 0, but instead got value of type Tensor. Declaration: forward((Tensor, Tensor) argument_1) -&gt; Tensor
</code></pre>
<p>æˆ–è€…</p>
<pre><code>Expected at most 1 argument(s) for operator 'forward', but received 2 argument(s). Declaration: forward((Tensor, Tensor) argument_1) -&gt; Tensor 
</code></pre>
<p>å¦å¤–è¿˜æœ‰åœ¨torch.jit.traceé˜¶æ®µå¯èƒ½ç¢°åˆ°çš„é”™è¯¯ï¼Œå¯ä»¥å¤šåŒ…è£¹ä¸€å±‚tupleè§£å†³ï¼Œä¾‹å¦‚((sample_input_1, sample_input_2),)ã€‚</p>
<pre><code>TypeError: forward() takes 2 positional arguments but 3 were given</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Universal Pooling]]></title>
        <id>https://txSangyj.github.io/post/universal-pooling/</id>
        <link href="https://txSangyj.github.io/post/universal-pooling/">
        </link>
        <updated>2019-07-30T01:57:38.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
é€›Paperweeklyçœ‹åˆ°çš„ä¸€ç¯‡è®ºæ–‡ï¼Œåªç”¨è¿‡æ± åŒ–è¿˜æ²¡çœ‹è¿‡ç›¸å…³è®ºæ–‡ã€‚çœ‹å®Œä¹Ÿæ²¡æœ‰å¤ªæƒŠè‰³çš„æ„Ÿè§‰ï¼Œå¯èƒ½æ± åŒ–æ“ä½œè¿˜æ˜¯ä¸è¢«çœ‹å¥½å§ã€‚InceptionV4ä¸­çš„Reduction Blockä¹Ÿæ˜¯Maxpoolingå’Œå·ç§¯å±‚åŒæ—¶ä½¿ç”¨ï¼ŒGANä¸ºäº†ä¸ä¸¢å¤±ä¿¡æ¯ä¹Ÿæ˜¯å·ç§¯å±‚æ›¿ä»£ï¼Œé™¤äº†Global average pooling (GAP)è¿™ç§æ›¿ä»£å…¨è¿æ¥å±‚çš„æ“ä½œã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E6%B1%A0%E5%8C%96">æ± åŒ–</a>
<ul>
<li><a href="#%E5%B8%B8%E7%94%A8%E6%B1%A0%E5%8C%96">å¸¸ç”¨æ± åŒ–</a></li>
<li><a href="#%E6%B1%A0%E5%8C%96%E4%BD%9C%E7%94%A8">æ± åŒ–ä½œç”¨</a></li>
</ul>
</li>
<li><a href="#universal-pooling">Universal Pooling</a></li>
<li><a href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98">å­˜åœ¨çš„é—®é¢˜</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>
<br>
é€›Paperweeklyçœ‹åˆ°çš„ä¸€ç¯‡è®ºæ–‡ï¼Œåªç”¨è¿‡æ± åŒ–è¿˜æ²¡çœ‹è¿‡ç›¸å…³è®ºæ–‡ã€‚çœ‹å®Œä¹Ÿæ²¡æœ‰å¤ªæƒŠè‰³çš„æ„Ÿè§‰ï¼Œå¯èƒ½æ± åŒ–æ“ä½œè¿˜æ˜¯ä¸è¢«çœ‹å¥½å§ã€‚InceptionV4ä¸­çš„Reduction Blockä¹Ÿæ˜¯Maxpoolingå’Œå·ç§¯å±‚åŒæ—¶ä½¿ç”¨ï¼ŒGANä¸ºäº†ä¸ä¸¢å¤±ä¿¡æ¯ä¹Ÿæ˜¯å·ç§¯å±‚æ›¿ä»£ï¼Œé™¤äº†Global average pooling (GAP)è¿™ç§æ›¿ä»£å…¨è¿æ¥å±‚çš„æ“ä½œã€‚</p>
<!-- more -->
<h1 id="æ± åŒ–">æ± åŒ–</h1>
<p>ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œä¸€èˆ¬åŒ…æ‹¬å·ç§¯å±‚ã€æ± åŒ–å±‚ä»¥åŠå…¨è¿æ¥å±‚ã€‚æ± åŒ–åœ¨å…¶ä¸­æ˜¯ä¸€ç§é™é‡‡æ ·çš„è¿‡ç¨‹ï¼Œä¸»è¦åˆ†ä¸ºå¹³å‡æ± åŒ–å’Œæœ€å¤§æ± åŒ–ã€‚</p>
<h2 id="å¸¸ç”¨æ± åŒ–">å¸¸ç”¨æ± åŒ–</h2>
<p>å¸¸è§çš„å°±æ˜¯Maxpoolingå’ŒMeanpoolingï¼Œå®¹æ˜“ç†è§£ï¼Œç›´æ¥ä¸Šå›¾ã€‚<br>
Maxpooling:<br>
<img src="https://i.loli.net/2019/07/31/5d40f8c5cf32a37790.png" alt="Maxpooling" loading="lazy"><br>
Meanpooling/Averagepooling:<br>
<img src="https://i.loli.net/2019/07/31/5d40f91906e0b64625.png" alt="Meanpooling" loading="lazy"></p>
<h2 id="æ± åŒ–ä½œç”¨">æ± åŒ–ä½œç”¨</h2>
<ul>
<li>é™é‡‡æ ·ï¼Œé™ä½å‚æ•°é‡å’Œè®¡ç®—é‡ã€‚</li>
<li>å¢å¤§åç»­å±‚å•å…ƒçš„æ„Ÿå—é‡ã€‚</li>
<li>é™ä½å¾®å¼±å™ªå£°å’Œç•¸å˜çš„å½±å“</li>
</ul>
<h1 id="universal-pooling">Universal Pooling</h1>
<p>æå‡ºçš„é€šç”¨æ± åŒ–å±‚å¯ä»¥ç”Ÿæˆä»»æ„ç±»å‹çš„æ± åŒ–ï¼Œæ ¸å¿ƒç±»ä¼¼æ³¨æ„åŠ›æœºåˆ¶ã€‚<br>
<strong>æ ¸å¿ƒ</strong>ï¼šUniversal pooling can be considered as a channel-wise local spatial attention module.</p>
<blockquote>
<p>The basic idea of universal pooling is to interpret pooling as attention and extend it to the general channelwise local spatial attention. That is, the  universal pooling selects pooling weights for each channel and they are <strong>trained</strong> together with other feature extraction parts.</p>
</blockquote>
<p>å®šä¹‰çš„æ± åŒ–æ“ä½œçš„é™åˆ¶ï¼š</p>
<ol>
<li>channel-wise:æ¯ä¸ªchannelåˆ†å¼€æ¥è®­ç»ƒæƒé‡å‚æ•° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span>ã€‚</li>
<li>ä»…æ± åŒ–ç»™å®šå—</li>
<li>æ± åŒ–ä¸èƒ½æ”¹å˜ç‰¹å¾çš„å°ºåº¦ï¼ˆå—å†…æƒé‡ä¹‹å’Œä¸º1ï¼‰<br>
<img src="https://i.loli.net/2019/07/30/5d3fda16bc1f829435.jpg" alt="ç»“æ„" loading="lazy"><br>
ç»“æ„ä¸ŠBlock1.1æ˜¯ä¸€ä¸ªå†…éƒ¨ç¥ç»ç½‘ç»œï¼Œè¿˜æ˜¯å¯ä»¥ä½¿ç”¨å·ç§¯å±‚ã€å…¨è¿æ¥å±‚ã€æ‰¹å½’ä¸€åŒ–å±‚ç­‰è¿›è¡Œæ„å»ºï¼Œç¥ç»ç½‘ç»œçš„è¾“å…¥æ˜¯å•ä¸ªç‰¹å¾å›¾ï¼Œè¾“å‡ºä¸ºä¸´æ—¶ç‰¹å¾å›¾ï¼Œå°ºå¯¸å’Œè¾“å…¥ç›¸åŒï¼Œç»è¿‡block1.2è¿›è¡Œå—å†…ï¼ˆå½¢çŠ¶ç”±æ­¥é•¿å†³å®šï¼‰çš„softmaxè½¬åŒ–ä¸ºå„åˆ†å—çš„å†…éƒ¨æƒé‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span></span>ï¼Œç„¶åPooling mapå’ŒFeature mapä½œç‚¹ç§¯ã€å—å†…æ±‚å’Œç­‰æ“ä½œå¾—åˆ°æ± åŒ–åçš„è¾“å‡ºã€‚</li>
</ol>
<h1 id="å­˜åœ¨çš„é—®é¢˜">å­˜åœ¨çš„é—®é¢˜</h1>
<ol>
<li>æ± åŒ–æ“ä½œä½¿ç”¨è¾ƒå°‘ï¼Œç‰¹å¾å›¾çš„å°ºåº¦å˜æ¢åŸºæœ¬ä¸Šç”±å·ç§¯å±‚çš„strideå’Œpaddingæ§åˆ¶ã€‚</li>
<li>å¢åŠ äº†å‚æ•°é‡å’Œè®¡ç®—é‡ï¼Œé™„åŠ äº†ä¸€ä¸ªå†…éƒ¨çš„ç¥ç»ç½‘ç»œï¼Œå¸¦æ¥äº†é¢å¤–çš„ç»“æ„è®¾è®¡é—®é¢˜ã€‚</li>
<li>å­¦ä¹ MaxPoolingè¿™ç§é«˜åº¦éçº¿æ€§åŒ–çš„å‡½æ•°å¯èƒ½å­˜åœ¨å›°éš¾ã€‚</li>
</ol>
<hr>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p><a href="https://arxiv.org/abs/1907.11440">è®ºæ–‡åœ°å€</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[C++ lambda]]></title>
        <id>https://txSangyj.github.io/post/c-lambda/</id>
        <link href="https://txSangyj.github.io/post/c-lambda/">
        </link>
        <updated>2019-07-18T06:49:17.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
C++ä¸­lambdaçš„ä»‹ç»å’Œç®€å•ä½¿ç”¨ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E6%9E%84%E6%88%90">æ„æˆ</a>
<ul>
<li><a href="#captures">captures</a></li>
<li><a href="#params">params</a></li>
<li><a href="#ret">ret</a></li>
<li><a href="#body">body</a></li>
</ul>
</li>
<li><a href="#%E4%BE%8B%E5%AD%90">ä¾‹å­</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>
<br>
C++ä¸­lambdaçš„ä»‹ç»å’Œç®€å•ä½¿ç”¨ã€‚</p>
<!-- more -->
<h1 id="æ„æˆ">æ„æˆ</h1>
<p>C++11ä¸‹lambdaè¡¨è¾¾å¼å®Œå…¨ä½“çš„æ„æˆï¼š<br>
[ captures ]  ( params ) specifiers exception attr -&gt; ret { body }</p>
<p>å…¶ä¸­paramså’Œretå¯ä»¥çœç•¥ï¼Œçœç•¥è¿”å›å€¼ç±»å‹ç›¸å½“äºè¿”å›autoç±»å‹ï¼Œçœç•¥ï¼ˆparamsï¼‰ç›¸å½“äºlambdaå‡½æ•°ä¸æ¥å—å‚æ•°è¾“å…¥ï¼Œå¯¹åº”ä»¥ä¸‹å‡ ç§å˜ä½“ï¼š</p>
<ul>
<li>[ captures ] ( params ) -&gt; ret { body }</li>
<li>[ captures ] ( params ) { body }</li>
<li>[ captures ] { body }</li>
</ul>
<h2 id="captures">captures</h2>
<p>æ”¯æŒå€¼æ•è·ã€å¼•ç”¨æ•è·å’Œéšå¼æ•è·ã€‚<br>
<strong>å€¼æ•è·å’Œå¼•ç”¨æ•è·</strong><br>
åœ¨å˜é‡å‰ä½¿ç”¨å‰ç¼€=æ¥è¡¨ç¤ºå€¼æ•è·ï¼Œ&amp;è¡¨ç¤ºå¼•ç”¨æ•è·ã€‚å˜é‡åœ¨capturesåˆ—è¡¨åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œå½“å˜é‡è¢«ä¸€ç§æ–¹å¼éšå¼æ•è·æ—¶ï¼Œæ˜¾ç¤ºæ•è·åªèƒ½å°†å…¶å£°æ˜ä¸ºå¦ä¸€ç§æ•è·æ–¹å¼ã€‚<br>
ã€1ã€‘ä¸­çš„ä¾‹å­ï¼š</p>
<pre><code class="language-c++">// é»˜è®¤å¼•ç”¨æ•è·
struct S2 { void f(int i); };
void S2::f(int i)
{
    [&amp;]{};          // OK: by-reference capture default
    [&amp;, i]{};       // OK: by-reference capture, except i is captured by copy
    [&amp;, &amp;i] {};     // Error: by-reference capture when by-reference is the default
    [&amp;, this] {};   // OK, equivalent to [&amp;]
    [&amp;, this, i]{}; // OK, equivalent to [&amp;, i]
}
</code></pre>
<pre><code class="language-c++">// é»˜è®¤å€¼æ•è·
struct S2 { void f(int i); };
void S2::f(int i)
{
    [=]{};          // OK: by-copy capture default
    [=, &amp;i]{};      // OK: by-copy capture, except i is captured by reference
    [=, *this]{};   // until C++17: Error: invalid syntax
                    // since c++17: OK: captures the enclosing S2 by copy
    [=, this] {};   // until C++20: Error: this when = is the default
                    // since C++20: OK, same as [=]
}
</code></pre>
<p><strong>éšå¼æ•è·</strong><br>
ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“æ•è·åˆ—è¡¨çš„é¦–é¡¹ä¸º=åŠ&amp;æ—¶ä¼šæŒ‰ç›¸åº”çš„æ•è·æ–¹å¼æ•è·æ‰€ç”¨çš„å˜é‡å’Œthisä¸‹çš„æˆå‘˜å˜é‡ã€‚å¦å¤–lambdaè¡¨è¾¾å¼å¯ä»¥ä¸æ•è·è€Œä½¿ç”¨æˆ–è¯»å–ä¸€äº›å˜é‡ï¼Œæ¯”å¦‚å…¨å±€å˜é‡ã€é™æ€å±€éƒ¨å˜é‡ç­‰ï¼Œå…·ä½“ç±»å‹å¯ä»¥æŸ¥çœ‹å‚è€ƒ[1]ã€‚</p>
<pre><code class="language-c++">
#include &lt;iostream&gt;
using namespace std;

int i = 10;
int main()
{
    static int j = 1;
    auto f = []() {cout &lt;&lt;&quot;i:&quot;&lt;&lt; i &lt;&lt;&quot;\tj:&quot;&lt;&lt; j; };
    f();
}
// out:
// i:10	j:1
</code></pre>
<h2 id="params">params</h2>
<p>å’Œå‡½æ•°å‚æ•°å·®ä¸å¤šï¼Œåœ¨C++14åä¸æ”¯æŒæŒ‡å®šå‚æ•°é»˜è®¤å€¼ä¸”æ”¯æŒç”¨autoå£°æ˜å‚æ•°ã€‚<br>
<strong>å‚æ•°åä¸å˜é‡åç›¸åŒä¼šéšè—æ‰€æ•è·çš„å˜é‡ã€‚</strong></p>
<h2 id="ret">ret</h2>
<p>è¿”å›å€¼ç±»å‹ï¼Œå¯çœç•¥ã€‚çœç•¥åè¦æ³¨æ„ä¸åŒåˆ†æ”¯ä¸‹è¿”å›å€¼ç±»å‹è¦ä¿æŒä¸€è‡´ã€‚</p>
<h2 id="body">body</h2>
<p>å‡½æ•°ä½“ã€‚å½“å˜é‡ä¸ºå€¼æ•è·æ—¶ï¼Œè¦åœ¨lambdaè¡¨è¾¾å¼çš„parameter listï¼ˆä¸å¯çœç•¥ï¼‰ å’Œ return typeï¼ˆçœç•¥æˆ–&quot;-&gt;ret&quot;å½¢å¼ï¼‰ä¹‹é—´æŒ‡å®šè¯´æ˜ç¬¦ä¸ºmutableæ‰èƒ½ä¿®æ”¹å˜é‡çš„å€¼ï¼Œä½†ä»æ˜¯å€¼å¼•ç”¨ã€‚</p>
<pre><code class="language-c++">
int i = 0;
auto f = [i]() mutable {return ++i; };
cout &lt;&lt; &quot;i:&quot; &lt;&lt; i &lt;&lt; &quot;\tf():&quot; &lt;&lt; f();

// out:
// i:0     f():1
</code></pre>
<h1 id="ä¾‹å­">ä¾‹å­</h1>
<p>åœ¨ä¸€äº›éœ€è¦è¾“å…¥å‡½æ•°çš„æ—¶å€™å°±å¯ä»¥ç”¨lambdaç”ŸæˆåŒ¿åå‡½æ•°ä¼ å…¥ï¼Œæ¯”å¦‚stdä¸­çš„sortã€for_eachç­‰å‡½æ•°ã€‚</p>
<pre><code class="language-c++">int main()
{
    using namespace std;
    vector&lt;int&gt; nums = { 1,2,3,4,5,6,7 };

    // ä½¿ç”¨lambdaå’Œfor_eachå®šä¹‰ä¸€ä¸ªå‡½æ•°ç”¨äºè¾“å‡ºvector
    auto print_vec = [](const vector&lt;int&gt; vec) {
        for_each(vec.begin(), vec.end(), [](int i) {cout &lt;&lt; i &lt;&lt; '\t'; });
    };
    print_vec(nums);
    cout &lt;&lt; endl;

    // å¼•ç”¨æ–¹å¼ä¿®æ”¹å€¼
    for_each(nums.begin(), nums.end(), [](int&amp; i) { i -= 4; });
    print_vec(nums);
    cout &lt;&lt; endl;

    // sortè‡ªå®šä¹‰æ’åº
    sort(nums.begin(), nums.end(), [](int a, int b) -&gt; bool { return abs(a) &lt; abs(b); }); 
    print_vec(nums);
    cout &lt;&lt; endl;
}
// out:
// 1       2       3       4       5       6       7
// -3      -2      -1      0       1       2       3
// 0       -1      1       -2      2       -3      3
</code></pre>
<hr>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p>[1]<a href="https://zh.cppreference.com/w/cpp/language/lambda">cppreference-lambda</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hexo è½¬åˆ° Gridea]]></title>
        <id>https://txSangyj.github.io/post/hexo-zhuan-dao-gridea/</id>
        <link href="https://txSangyj.github.io/post/hexo-zhuan-dao-gridea/">
        </link>
        <updated>2019-07-17T06:36:21.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
é€›è®ºå›æ—¶å€™å‘ç°ä¸ªæ–°ç©å…·<a href="https://gridea.dev/">Gridea</a>ï¼Œç„¶åå°±æŠŠåŸæ¥Hexoä¸‹çš„ä¸œè¥¿è¿åˆ°äº†Grideaä¸‹ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E9%85%8D%E7%BD%AE">é…ç½®</a></li>
<li><a href="#%E6%96%87%E7%AB%A0">æ–‡ç« </a></li>
<li><a href="#%E5%9B%BE%E7%89%87">å›¾ç‰‡</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E9%97%AE%E9%A2%98">å…¶ä»–é—®é¢˜</a></li>
</ul>
<br>
é€›è®ºå›æ—¶å€™å‘ç°ä¸ªæ–°ç©å…·<a href="https://gridea.dev/">Gridea</a>ï¼Œç„¶åå°±æŠŠåŸæ¥Hexoä¸‹çš„ä¸œè¥¿è¿åˆ°äº†Grideaä¸‹ã€‚</p>
<!-- more -->
<h1 id="é…ç½®">é…ç½®</h1>
<p>ä¸Šæ•™ç¨‹<a href="https://gridea.dev/docs/">Gridea doc</a></p>
<h1 id="æ–‡ç« ">æ–‡ç« </h1>
<p>åŸHexoçš„source/_postä¸‹çš„.mdæ–‡ä»¶å¤åˆ¶åˆ°Grideaæºæ–‡ä»¶å¤¹ä¸‹çš„postsä¸‹ã€‚æ³¨æ„postsä¸‹<strong>ä¸èƒ½</strong>æœ‰æ–‡ä»¶å¤¹ã€‚<s>å¯èƒ½æ˜¯Bugå§ã€‚</s></p>
<h1 id="å›¾ç‰‡">å›¾ç‰‡</h1>
<p>åˆä¸èƒ½æœ‰asset_folderï¼ŒGrideaæ’å…¥çš„å›¾ç‰‡ä½¿ç”¨çš„åˆæ˜¯ç»å¯¹è·¯å¾„ï¼Œæ‰€ä»¥æŠŠä¹‹å‰çš„å›¾ç‰‡è½¬æˆäº†å›¾åºŠé“¾æ¥ã€‚ç”¨çš„æ˜¯<a href="https://github.com/kookob/smpic">Simpic</a>ä¸Šä¼ ã€‚</p>
<h1 id="å…¶ä»–é—®é¢˜">å…¶ä»–é—®é¢˜</h1>
<ul>
<li>åŸæ¥çš„ä¸»é¢˜ä¸ä¼šé€‚é…ã€‚</li>
<li>æ–‡ç« çš„åˆ†ç±»æ²¡æœ‰è‡ªåŠ¨è¯†åˆ«ã€‚</li>
<li>Grideaä¸‹å†™ä¸œè¥¿<strong>åƒä¸‡ä¸è¦éšä¾¿ç‚¹è¿”å›</strong>ã€‚</li>
<li>å»ºè®®æ–‡ç« éƒ½æ·»åŠ &lt;!-- more --&gt;ä¸ç„¶æœ‰çš„ä¸»é¡µæ˜¾ç¤ºä¼šå‡ºç°é”™ä½ã€‚</li>
<li>å­—æ•°ç»Ÿè®¡ã€ç‚¹å‡»ç»Ÿè®¡å¥½åƒæš‚ä¸æ”¯æŒã€‚</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[python å¤šçº¿ç¨‹/å¤šè¿›ç¨‹]]></title>
        <id>https://txSangyj.github.io/post/multithreaded-multiprocessing/</id>
        <link href="https://txSangyj.github.io/post/multithreaded-multiprocessing/">
        </link>
        <updated>2018-12-28T11:55:14.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
è¿›ç¨‹å’Œçº¿ç¨‹åŒºåˆ«ä¹Ÿæ˜¯å¸¸é—®çš„é—®é¢˜ï¼Œè¿™ä¹Ÿè®°ä¸€ä¸‹ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B">è¿›ç¨‹å’Œçº¿ç¨‹</a>
<ul>
<li><a href="#%E8%BF%9B%E7%A8%8B">è¿›ç¨‹</a></li>
<li><a href="#%E7%BA%BF%E7%A8%8B">çº¿ç¨‹</a></li>
<li><a href="#%E5%8C%BA%E5%88%AB">åŒºåˆ«</a></li>
</ul>
</li>
<li><a href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B">å¤šçº¿ç¨‹</a>
<ul>
<li><a href="#gil">GIL</a></li>
<li><a href="#threading">threading</a></li>
</ul>
</li>
<li><a href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B">å¤šè¿›ç¨‹</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>
<br>
è¿›ç¨‹å’Œçº¿ç¨‹åŒºåˆ«ä¹Ÿæ˜¯å¸¸é—®çš„é—®é¢˜ï¼Œè¿™ä¹Ÿè®°ä¸€ä¸‹ã€‚</p>
<!-- more -->
<h1 id="è¿›ç¨‹å’Œçº¿ç¨‹">è¿›ç¨‹å’Œçº¿ç¨‹</h1>
<h2 id="è¿›ç¨‹">è¿›ç¨‹</h2>
<p>å¯æ‰§è¡Œçš„ç¨‹åºåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç³»ç»Ÿä¸ºå®ƒåˆ†é…èµ„æºåè¿è¡Œä¸­çš„ç¨‹åºç§°ä¹‹ä¸ºè¿›ç¨‹ã€‚è¿›ç¨‹æ˜¯ç¨‹åºå…³äºæŸæ•°æ®é›†åˆçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…ï¼ˆåœ°å€ç©ºé—´ã€å†…å­˜ã€æ•°æ®æ ˆï¼‰å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚</p>
<h2 id="çº¿ç¨‹">çº¿ç¨‹</h2>
<p>çº¿ç¨‹è¢«åŒ…å«åœ¨è¿›ç¨‹ä¸­ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚çº¿ç¨‹æ˜¯å±äºè¿›ç¨‹çš„ï¼ŒåŒä¸€è¿›ç¨‹ä¸‹çš„çº¿ç¨‹å…±äº«ç›¸åŒçš„è¿è¡Œç¯å¢ƒã€‚</p>
<h2 id="åŒºåˆ«">åŒºåˆ«</h2>
<ol>
<li>
<p>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„å•ä½ï¼›çº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„å•ä½ã€‚</p>
</li>
<li>
<p>è¿›ç¨‹é—´åˆ‡æ¢ä»£ä»·å¤§ï¼›çº¿ç¨‹é—´åˆ‡æ¢ä»£ä»·å°ã€‚</p>
</li>
<li>
<p>è¿›ç¨‹æ‹¥æœ‰èµ„æºå¤šï¼›çº¿ç¨‹æ‹¥æœ‰èµ„æºå°‘ã€‚</p>
</li>
<li>
<p>è¿›ç¨‹é—´ä¸èƒ½ç›´æ¥å…±äº«ä¿¡æ¯ï¼›çº¿ç¨‹é—´å¯ä»¥é€šè¿‡å…±äº«æ•°æ®é€šä¿¡ã€‚</p>
</li>
<li>
<p>ä¸€ä¸ªè¿›ç¨‹æ­»æ‰ä¸å½±å“å…¶ä»–è¿›ç¨‹ï¼›è¿›ç¨‹ä¸‹çš„çº¿ç¨‹æ­»æ‰ä¼šå¯¼è‡´è¿›ç¨‹æ­»æ‰ã€‚</p>
<blockquote>
<p>ï¼ˆæ‰€ä»¥å†™å¤šè¿›ç¨‹çš„æ—¶å€™æ€»æ˜¯åŒæ ·çš„é”™æŠ¥å››æ¬¡hhhï¼‰</p>
</blockquote>
</li>
</ol>
<h1 id="å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</h1>
<h2 id="gil">GIL</h2>
<p>Pythonä»£ç æ‰§è¡Œç”±Pythonè™šæ‹Ÿæœºæ§åˆ¶ï¼Œè€Œå¯¹Pythonè™šæ‹Ÿæœºçš„è®¿é—®ç”±å…¨å±€è§£é‡Šå™¨é”GILæ§åˆ¶ï¼Œå®ƒä¿è¯å³ä½¿åœ¨å¤šæ ¸å¿ƒå¤„ç†å™¨ä¸ŠåŒä¸€æ—¶åˆ»ä¹Ÿåªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è™šæ‹Ÿæœºçš„è¿è¡Œæ–¹å¼æ˜¯ï¼ˆè·å¾—é”-åˆ‡æ¢åˆ°ä¸€ä¸ªçº¿ç¨‹è¿è¡Œ-é—´éš”æ£€æŸ¥/sleep-ç¡çœ -è§£é”ï¼‰çš„å¾ªç¯ã€‚</p>
<p>çº¿ç¨‹åœ¨å¤„ç†I/Oè°ƒç”¨çš„æ—¶å€™ä¼šé‡Šæ”¾GILï¼Œè€ŒCPUå¯†é›†å‹çš„çº¿ç¨‹ä¼šåœ¨è‡ªå·±çš„æ—¶é—´ç‰‡å†…ä¸€ç›´å ç”¨å¤„ç†å™¨ã€‚æ‰€ä»¥CPUå¯†é›†å‹çš„ä»»åŠ¡ä¸æ¨èä½¿ç”¨å¤šçº¿ç¨‹ã€‚</p>
<h2 id="threading">threading</h2>
<p>threadingçš„Threadç±»æä¾›ä¸¤ç§æ–¹å¼åˆ›å»ºçº¿ç¨‹ï¼š1ã€ä¼ é€’ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼›2ã€æ´¾ç”Ÿä¸€ä¸ªå­ç±»ï¼Œé‡å†™runæ–¹æ³•ã€‚</p>
<pre><code class="language-python">import threading
from time import sleep,ctime

def loop(x):
    t = ctime()
    sleep(x)
    print(&quot;{0} start at {1},stop at {2}&quot;.format(
        threading.current_thread().getName(),t,ctime()))
    return x

class MyThread(threading.Thread):
    
    def __init__(self, target=None ,args=()):
        self.result = None
        return super().__init__(target=target,args=args)
    
    #ä½¿ç”¨å­ç±»ç»§æ‰¿çš„å¥½å¤„å°±æ˜¯æ›´åŠ çµæ´»
    def getResult(self):
        return self.result
    
    def run(self):
        self.result = self._target(*self._args)

if __name__ == '__main__':
    
    #ä½¿ç”¨Threadç±»
    for i in range(4):
        mythread = threading.Thread(target = loop,args = (i,))
        mythread.start()
    sleep(4)
    #ä½¿ç”¨MyThreadç±»
    thread_list = []
    for i in range(4):
        my_thread = MyThread(target=loop,args=(i,))
        my_thread.start()
        thread_list.append(my_thread)
    
    for t in thread_list:
        t.join()
    for t in thread_list:
        print(t.getResult())
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/07/16/5d2de1b3af4d466932.png" alt="è¿è¡Œæˆªå›¾" loading="lazy"></figure>
<ul>
<li>printå‡½æ•°ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥ç”¨sys.stdout.writeæ–¹æ³•æ›¿æ¢ã€‚</li>
<li>è¿™æ®µæ²¡æœ‰çº¿ç¨‹é€šä¿¡ï¼Œå‚è€ƒé‡Œæœ‰è®²çš„å¾ˆè¯¦ç»†çš„æ–‡ç« ã€‚</li>
</ul>
<h1 id="å¤šè¿›ç¨‹">å¤šè¿›ç¨‹</h1>
<p>Pythonå¤šè¿›ç¨‹ä½¿ç”¨çš„æ˜¯multiprocessingåŒ…ï¼Œåœ¨æ¥å£å®šä¹‰ä¸Šä¸threadingå¤§è‡´ç›¸åŒã€‚</p>
<pre><code>import multiprocessing as mp   
import sys
from time import sleep,ctime

def loop(x):
    t = ctime()
    sleep(x)
    sys.stdout.write(&quot;{0} start at {1},stop at {2}\n&quot;.format(
        mp.process.current_process(),t,ctime()))

    return x

if __name__ == '__main__':
    
    #ç±»ä¼¼äºthreadingçš„ç”¨æ³•
    for i in range(4):
        my_process = mp.Process(target = loop,args = (i,))
        my_process.start()
    sleep(4)

    #ä½¿ç”¨è¿›ç¨‹æ± ï¼Œå¯ä»¥è·å–å‡½æ•°çš„è¿”å›å€¼
    pool = mp.Pool()
    res = pool.map(loop,range(4)) #mapæ¥æ”¶å¯è¿­ä»£å¯¹è±¡
    print(res)
    
    #é˜»å¡æ‰§è¡Œçš„apply
    res_list = [pool.apply(loop,(i,)) for i in range(4)]
    print(res_list)
    
    #å¼‚æ­¥éé˜»å¡çš„apply_async
    res_list = [pool.apply_async(loop,(i,)).get() for i in range(4)]
    print(res_list)
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/07/16/5d2de1d4531ef71329.png" alt="è¿è¡Œæˆªå›¾" loading="lazy"></figure>
<p>å¤šè¿›ç¨‹æœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œè¿›ç¨‹é—´pickleè¿›è¡Œæ•°æ®åºåˆ—åŒ–ä¼ é€’æ•°æ®ï¼Œç„¶è€Œæœ‰äº›æ•°æ®ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œå›¾ç‰‡æ¥è‡ª[5]ã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/07/16/5d2de1bc235d083052.png" alt="èƒ½è¢«åºåˆ—åŒ–çš„å¯¹è±¡" loading="lazy"></figure>
<p>å†å¼•ä¸€å¼ è¿›ç¨‹æ± å·¥ä½œæ–¹å¼çš„å›¾ï¼Œæ„Ÿè§‰å¾ˆæœ‰ç”¨ï¼Œæ¥è‡ª[4]ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/07/16/5d2de1e40b90751549.png" alt="è¿›ç¨‹æ± å·¥ä½œæ–¹å¼" loading="lazy"></figure>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p>[1] äº†è§£GILçœ‹è¿™é‡Œhttp://cenalulu.github.io/python/gil-in-python/</p>
<p>[2] å¤šçº¿ç¨‹è¿™ç¯‡å†…å®¹æ›´å…¨é¢http://codingpy.com/article/python-201-a-tutorial-on-threads/</p>
<p>[3] å¤šè¿›ç¨‹pickleé—®é¢˜è§£å†³çœ‹è¿™é‡Œhttps://strcpy.me/index.php/archives/318/</p>
<p>[4] è¿›ç¨‹æ± æºç è§£æhttp://www.codexiu.cn/python/blog/939/</p>
<p>[5] https://docs.python.org/2/library/pickle.html#what-can-be-pickled-and-unpickled</p>
<p>PPSç»ˆäºé‡æ–°å¼€å§‹è®°ç¬”è®°äº†ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Attention Mechanism]]></title>
        <id>https://txSangyj.github.io/post/Attention-Mechanism/</id>
        <link href="https://txSangyj.github.io/post/Attention-Mechanism/">
        </link>
        <updated>2018-10-16T07:01:33.000Z</updated>
        <summary type="html"><![CDATA[<p></p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E5%8E%9F%E7%90%86">åŸç†</a>
<ul>
<li><a href="#soft-attention">soft attention</a></li>
<li><a href="#%E6%8A%BD%E8%B1%A1">æŠ½è±¡</a></li>
</ul>
</li>
<li><a href="#%E5%88%86%E7%B1%BB">åˆ†ç±»</a></li>
<li><a href="#attention-is-all-you-need">â€˜Attention is all you needâ€™</a>
<ul>
<li><a href="#scaled-dot-product-attention">Scaled Dot-Product Attention</a></li>
<li><a href="#multi-head-attention">Multi-Head Attention</a></li>
<li><a href="#self-attention">Self Attention</a></li>
</ul>
</li>
<li><a href="#%E5%BA%94%E7%94%A8">åº”ç”¨</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>
</p>
<!-- more -->
<h1 id="åŸç†">åŸç†</h1>
<h2 id="soft-attention">soft attention</h2>
<p>åœ¨seq2seqä¸­æœ€åŸºæœ¬çš„æ¨¡å‹åŒ…å«ä¸€ä¸ªencoderå’Œä¸€ä¸ªdecoderï¼Œencoderå°†è¾“å…¥åºåˆ—æ˜ å°„ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„éšå±‚è¾“å‡ºå‘é‡ï¼ˆä¸­é—´è¯­ä¹‰ï¼‰ï¼Œdecoderæ ¹æ®ä¸­é—´è¯­ä¹‰å’Œå†å²ç”Ÿæˆä¿¡æ¯æ¥ç”Ÿæˆå½“å‰æ—¶åˆ»çš„å•è¯ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi><mo>(</mo><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">y_i=g(h,y_1,\cdots,y_{i-1})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><a href="https://arxiv.org/pdf/1409.0473.pdf">1</a>ä¸­æå‡ºçš„æ”¹è¿›ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ¦‚å¿µå«context vectorï¼Œæ¯ä¸ªæ—¶é—´ç‚¹çš„è¾“å‡º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ç”±ä¸åŒçš„éšå±‚å‘é‡è®¡ç®—è€Œæ¥ï¼Œå®šä¹‰äº†ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡ï¼Œå¦‚ä¸‹å¼ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>=</mo><mi>g</mi><mo>(</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p(y_i|y_1,\cdots,y_{i-1})=g(y_{i-1},s_i,c_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>å…¶ä¸­<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>æ˜¯éšå±‚çŠ¶æ€ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å³ä¸ºcontext vectorï¼Œéšå±‚çŠ¶æ€çš„è®¡ç®—ä¹Ÿæ˜¯ä¸context vectorç›¸å…³ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi>f</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">s_i=f(s_{i-1},y_{i-1},c_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>x</mi></msub></munderover><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>h</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">c_i=\sum_{j=1}^{T_x}\alpha_{ij}h_j
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2532130000000006em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394360000000005em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.311105em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">e_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ç”¨æ¥åº¦é‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>é™„è¿‘çš„è¾“å…¥å’Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä½ç½®è¾“å‡ºçš„åŒ¹é…ç¨‹åº¦ï¼Œä½¿ç”¨softmaxå‡½æ•°å°†å…¶è½¬åŒ–ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œç„¶åä½œä¸ºæƒé‡ä¸encoderè¾“å‡ºçš„éšå±‚å‘é‡è¿›è¡Œç‚¹ç§¯å¾—åˆ°å½“å‰æ—¶åˆ»çš„context vectorã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Î±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>x</mi></msub></munderover><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\alpha_{ij}=\frac{exp(e_{ij})}{\sum_{k=1}^{T_x}exp(e_{ik})}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.597941em;vertical-align:-1.170941em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.128769em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.170941em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>a</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">e_{ij}=a(s_{i-1},h_j)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>è®ºæ–‡ä¸­è¿™é‡Œçš„aå‡½æ•°ä½¿ç”¨äº†ä¸€ä¸ªå¯¹é½æ¨¡å‹(ç¥ç»ç½‘ç»œ)æ¥åº¦é‡ç›¸ä¼¼ç¨‹åº¦ï¼Œç†è®ºä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–åº¦é‡æ¯”å¦‚ä½™å¼¦ç›¸ä¼¼åº¦ã€dç‚¹ç§¯ã€çŸ©é˜µå˜æ¢ç­‰ã€‚</p>
<h2 id="æŠ½è±¡">æŠ½è±¡</h2>
<p>Attentionæœºåˆ¶å¯ä»¥è¢«æŠ½è±¡ä¸ºå°†Queryå’Œä¸€ç»„é”®å€¼å¯¹(Key,Value)æ˜ å°„åˆ°ä¸€ä¸ªè¾“å‡ºçš„è¿‡ç¨‹ã€‚å…ˆæ ¹æ®Queryå’ŒKeyè®¡ç®—ç›¸ä¼¼æ€§æˆ–ç›¸å…³æ€§ï¼Œç„¶åå¯¹ç›¸ä¼¼æ€§æˆ–ç›¸å…³æ€§è¿›è¡Œå½’ä¸€åŒ–ï¼Œè½¬åŒ–ä¸ºæƒé‡ç³»æ•°ï¼Œæœ€åæ ¹æ®æƒé‡ç³»æ•°å¯¹Valueè¿›è¡ŒåŠ æƒæ±‚å’Œã€‚ï¼ˆè¿™é‡Œæ˜¯soft attentionï¼‰</p>
<h1 id="åˆ†ç±»">åˆ†ç±»</h1>
<p>é™¤å»ç›¸å…³åº¦çš„ä¸åŒè®¡ç®—æ–¹å¼ï¼ŒAttentionæœºåˆ¶è¿˜æœ‰ä¸‹é¢å‡ ç§åˆ†ç±»ã€‚<br>
<strong>soft attention &amp; hard attention</strong><br>
soft attentionæ˜¯å‚æ•°åŒ–çš„ã€å¯å¯¼çš„ï¼Œå¯ä»¥ç›´æ¥åµŒå…¥åˆ°æ¨¡å‹ä¸­è¿›è¡Œè®­ç»ƒã€‚<br>
hard attentionæ˜¯éšæœºçš„è¿‡ç¨‹ï¼Œä»¥è®¡ç®—å¾—åˆ°çš„æƒé‡ç³»æ•°s_iä½œä¸ºæ¦‚ç‡éšæœºé‡‡æ ·ä¸€éƒ¨åˆ†y_iæ¥è¿›è¡Œè®¡ç®—ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨æ¢¯åº¦åå‘ä¼ æ’­è®­ç»ƒï¼Œéœ€è¦ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ã€‚å› æ­¤ä¸»æµæ˜¯ä½¿ç”¨soft attentionã€‚<br>
<code>ç†è§£ä¸äº†çš„è¯å¯ä»¥çœ‹ä¸€ä¸‹å‚è€ƒ3é‡Œçš„å›¾ç‰‡</code></p>
<p><strong>global attention &amp; local attention</strong><br>
è¿™ä¸ªåˆ†ç±»ä¹Ÿæ˜¯å¯ä»¥ç†è§£çš„ï¼Œglobal Attentionçš„context vectorçš„è®¡ç®—ä¸å…¨éƒ¨çš„éšå±‚çŠ¶æ€ç›¸å…³ï¼Œè€Œlocal Attentionåªæ¶‰åŠåˆ°iä½ç½®é™„è¿‘æŸä¸€å¤§å°çš„çª—å£å†…çš„éšå±‚çŠ¶æ€ã€‚</p>
<h1 id="attention-is-all-you-need">â€˜Attention is all you needâ€™</h1>
<p>Googleåœ¨æ–‡ç« <a href="https://arxiv.org/pdf/1706.03762.pdf">2</a>æå‡ºä¸€ä¸ªtransformeræ¨¡å‹ï¼Œåªä½¿ç”¨Attentionå®Œæˆäº†ä¸€ä¸ªseq2seqæ¡†æ¶ã€‚ä¸»è¦åº”ç”¨äº†ä¸‰ç§Attentionæœºåˆ¶ï¼šencoder-decoder attentionã€encoder self-attentionã€decoder self-attentionã€‚æ·»åŠ äº†self Attentionæ•æ‰encoderç«¯å’Œdecoderç«¯è‡ªèº«è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p>
<h2 id="scaled-dot-product-attention">Scaled Dot-Product Attention</h2>
<p>Googleç»™å‡ºçš„Scaled Dot-Product Attentionçš„å®šä¹‰å¦‚ä¸‹å¼ï¼ŒQã€Kã€Våˆ†åˆ«ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">nÃ—d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">d_kÃ—m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>Ã—</mo><msub><mi>d</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">mÃ—d_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„çŸ©é˜µã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo>)</mo><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo>)</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">Attention(Q,K,V)=softmax(\frac{QK^T}{\sqrt{d_k}})V
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.448331em;vertical-align:-0.93em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.25278em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></span></p>
<h2 id="multi-head-attention">Multi-Head Attention</h2>
<p>ç„¶ååœ¨Scaled Dot-Product Attentionçš„åŸºç¡€ä¸Šå®šä¹‰Multi-Head Attentionã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>(</mo><mi>Q</mi><msubsup><mi>W</mi><mi>i</mi><mi>Q</mi></msubsup><mo separator="true">,</mo><mi>K</mi><msubsup><mi>W</mi><mi>i</mi><mi>K</mi></msubsup><mo separator="true">,</mo><mi>V</mi><msubsup><mi>W</mi><mi>i</mi><mi>V</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">head_i = Attention(QW^Q_i, KW^K_i, V W^V_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.236103em;vertical-align:-0.276864em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">Q</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9592389999999998em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.180908em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo>(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo>)</mo><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo>(</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>h</mi></msub><mo>)</mo><msup><mi>W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">MultiHead(Q, K, V ) = Concat(head_1, ..., head_h)W^O
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><code>ä¸æ‡‚è¿˜æ˜¯çœ‹ä»£ç å¥½...å‚è€ƒ2é‡Œæœ‰å®ç°çš„ä»£ç ã€‚</code><br>
<strong>encoder-decoder attention</strong>ï¼šè¾“å…¥ä¸ºencoderçš„è¾“å‡ºå’Œdecoderçš„self-attentionè¾“å‡ºï¼Œå…¶ä¸­encoderçš„self-attentionä½œä¸ºkey and valueï¼Œdecoderçš„self-attentionä½œä¸ºquery</p>
<h2 id="self-attention">Self Attention</h2>
<p>self attentionå³è¾“å…¥çš„Qã€Kã€Véƒ½æ˜¯ä¸€æ ·çš„ã€‚å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo>(</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">MultiHead(X,X,X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>.<br>
<strong>encoder self-attention</strong>ï¼šè¾“å…¥çš„Qã€Kã€Véƒ½æ˜¯input embedding and positional embedding<br>
<strong>decoder self-attention</strong>ï¼šä½¿ç”¨masked multi-head attentionï¼Œè¾“å…¥çš„Qã€Kã€Véƒ½æ˜¯output embedding and positional embedding</p>
<h1 id="åº”ç”¨">åº”ç”¨</h1>
<p>è‡ªæå‡ºä»¥æ¥ï¼ŒAttention Mechanismåº”ç”¨ååˆ†å¹¿æ³›ï¼Œåœ¨æœºå™¨ç¿»è¯‘[<a href="https://arxiv.org/pdf/1409.0473.pdf">1</a>,2]ã€å›¾åƒæ ‡æ³¨ã€è¯­éŸ³è¯†åˆ«ã€æ‘˜è¦ç”Ÿæˆç­‰æ–¹é¢éƒ½æœ‰åº”ç”¨ï¼Œæœ‰å…´è¶£çš„è¯å¯ä»¥è¯»ä¸€ä¸‹ç›¸å…³çš„è®ºæ–‡ã€‚</p>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p>1ï¼šhttps://machinelearningmastery.com/attention-long-short-term-memory-recurrent-neural-networks/<br>
2ï¼šhttps://kexue.fm/archives/4765<br>
3ï¼šhttps://blog.heuritech.com/2016/01/20/attention-mechanism/</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Multi-Task Learning]]></title>
        <id>https://txSangyj.github.io/post/Multi-Task-Learning/</id>
        <link href="https://txSangyj.github.io/post/Multi-Task-Learning/">
        </link>
        <updated>2018-09-19T06:20:24.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
çœ‹äº†ä¸€äº›ç›®æ ‡æ£€æµ‹çš„è®ºæ–‡ä¹‹åå‘ç°å¯¹å¤šä»»åŠ¡å­¦ä¹ ä¸å¤Ÿäº†è§£ï¼Œä¸‹é¢çš„å†…å®¹æ˜¯<a href="https://arxiv.org/abs/1706.05098">Multi-Taks Learningç»¼è¿°è®ºæ–‡</a>çš„éƒ¨åˆ†æ€»ç»“ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E6%A6%82%E5%BF%B5">æ¦‚å¿µ</a>
<ul>
<li><a href="#%E4%B8%A4%E7%A7%8D%E5%85%B1%E4%BA%AB%E6%96%B9%E5%BC%8F">ä¸¤ç§å…±äº«æ–¹å¼</a></li>
</ul>
</li>
<li><a href="#mtl%E6%9C%89%E6%95%88%E7%9A%84%E5%8E%9F%E5%9B%A0">MTLæœ‰æ•ˆçš„åŸå› </a></li>
<li><a href="#dl%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E5%92%8C%E5%8F%91%E5%B1%95">DLä¸­çš„åº”ç”¨å’Œå‘å±•</a></li>
<li><a href="#%E8%BE%85%E5%8A%A9%E4%BB%BB%E5%8A%A1">è¾…åŠ©ä»»åŠ¡</a></li>
</ul>
<br>
çœ‹äº†ä¸€äº›ç›®æ ‡æ£€æµ‹çš„è®ºæ–‡ä¹‹åå‘ç°å¯¹å¤šä»»åŠ¡å­¦ä¹ ä¸å¤Ÿäº†è§£ï¼Œä¸‹é¢çš„å†…å®¹æ˜¯<a href="https://arxiv.org/abs/1706.05098">Multi-Taks Learningç»¼è¿°è®ºæ–‡</a>çš„éƒ¨åˆ†æ€»ç»“ã€‚</p>
<!-- more -->
<h1 id="æ¦‚å¿µ">æ¦‚å¿µ</h1>
<p>åœ¨ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ä¸­é€šå¸¸é’ˆå¯¹ä¸€ä¸ªä»»åŠ¡æ¥ä¼˜åŒ–æ¨¡å‹ï¼Œå¯¹ä¸åŒçš„ä»»åŠ¡ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ã€‚Multi-Task Learning(MTL)ä½¿ç”¨å…±äº«æŸäº›éšå±‚è¡¨è¾¾çš„æ–¹å¼æ¥å®ç°åŒæ—¶å®Œæˆå¤šä¸ªä»»åŠ¡(æˆ–æ˜¯åˆ©ç”¨è¾…åŠ©ä»»åŠ¡æå‡ä¸»ä»»åŠ¡çš„æ•ˆæœ)ã€‚</p>
<p>ä¾‹å¦‚åœ¨Fast RCNNä¸­ï¼Œobject Classifier å’Œbounding box regressorå…±äº«Conv feature mapï¼Œä½¿ç”¨multi-task lossæ¥è¿›è¡Œè®­ç»ƒï¼Œå¯ä»¥åŒæ—¶å®Œæˆç›®æ ‡è¯†åˆ«ä¸å®šä½ã€‚</p>
<h2 id="ä¸¤ç§å…±äº«æ–¹å¼">ä¸¤ç§å…±äº«æ–¹å¼</h2>
<p>æåˆ°çš„å¤šä»»åŠ¡å­¦ä¹ ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š<br>
<strong>hard parameter sharing</strong>ï¼šä¸åŒä»»åŠ¡ç›´æ¥å…±äº«éšè—å±‚ã€‚<br>
<code>é™ä½è¿‡æ‹Ÿåˆé£é™©ï¼ˆç›¸å¯¹äºå•ä¸€ä»»åŠ¡ï¼Œæ¨¡å‹è¦å­¦ä¹ æ›´å¤šæ›´é€šç”¨çš„è¡¨è¾¾ã€‚ï¼‰</code><br>
**soft parameter sharingï¼š**æ¯ä¸ªä»»åŠ¡å¯¹åº”ä¸€ä¸ªæ¨¡å‹ï¼Œæ·»åŠ é¢å¤–çš„æƒé‡ä»£ä»·ï¼ˆL2ï¼Œtrace normï¼‰çº¦æŸå„ä¸ªæ¨¡å‹ä¸­çš„æŸäº›å±‚ã€‚<br>
<code>åœ¨éç¥ç»ç½‘ç»œçš„æ–¹æ³•ä¸­æ›´å¸¸è§ã€‚</code></p>
<h1 id="mtlæœ‰æ•ˆçš„åŸå› ">MTLæœ‰æ•ˆçš„åŸå› </h1>
<ol>
<li>åŒæ ·çš„æ•°æ®é›†å¯¹äºä¸åŒçš„ä»»åŠ¡ï¼Œå™ªå£°çš„å®šä¹‰å¯èƒ½æ˜¯ä¸åŒçš„ï¼ŒåŒæ—¶å­¦ä¹ ç›®æ ‡Aå’ŒBå¯¹äºç›®æ ‡çš„å¯¹åº”å™ªå£°æœ‰å¹³å‡çš„æ•ˆæœï¼Œä¹Ÿèƒ½é˜²æ­¢è¿‡æ‹Ÿåˆå…¶ä¸­ä¸€ä¸ªç›®æ ‡ï¼›</li>
<li>ä»»åŠ¡Aéš¾ä»¥è¢«å­¦ä¹ æ—¶ï¼Œé‚£äº›å¯¹ä»»åŠ¡Bæœ‰ç”¨çš„ç‰¹å¾å¯èƒ½å¯¹AåŒæ ·æœ‰ç”¨ï¼›</li>
<li>å¯¹äºä¸åŒä»»åŠ¡ï¼Œéšå±‚å­¦ä¹ åˆ°çš„ç‰¹å¾ä¹Ÿæœ‰ä¸åŒï¼Œå…±äº«éšå±‚å¢åŠ äº†ç‰¹å¾æ•°é‡ï¼›</li>
<li>å¤šä»»åŠ¡æ¨¡å‹å­¦ä¹ åˆ°çš„Feature Representationæœ‰åˆ©äºæ–°ä»»åŠ¡çš„æ¨å¹¿ï¼›</li>
<li>æœ‰æ­£åˆ™åŒ–æ•ˆæœã€‚<br>
<strong>ä»»åŠ¡ä¹‹é—´è¦ç›¸å…³ï¼Œå¦åˆ™ç»“æœå¯èƒ½æ›´å·®</strong></li>
</ol>
<h1 id="dlä¸­çš„åº”ç”¨å’Œå‘å±•">DLä¸­çš„åº”ç”¨å’Œå‘å±•</h1>
<p>DLä¸­å±‚ä¸å±‚ä¹‹é—´çš„äº’è”æˆ–è€…è¯´ç»“æ„ä¹‹é—´çš„äº’è”å¤©ç„¶åœ°ä¸ºhard parameter sharingæä¾›äº†åŸºç¡€ï¼Œå¯ä»¥ç®€å•çš„é¢„å®šä¹‰æŸäº›å±‚ä¸ºå…±äº«å±‚ã€‚MTLåœ¨æ·±åº¦å­¦ä¹ ä¸Šè¿˜æœ‰ä¸€äº›å…¶ä»–çš„ç»“æ„æ¯”å¦‚Fully-Adaptive Feature Sharingã€Tensor factorisation for MTLç­‰ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä»»åŠ¡ä¸æ˜¯ç´§å¯†ç›¸å…³æˆ–è€…éœ€è¦åœ¨ä¸åŒçº§åˆ«ä¸Šè¿›è¡Œè¿›ä¸€æ­¥æ¨ç†ï¼Œè¿™æ ·çš„å‚æ•°å…±äº«æ•ˆæœå¹¶ä¸å¥½ã€‚</p>
<h1 id="è¾…åŠ©ä»»åŠ¡">è¾…åŠ©ä»»åŠ¡</h1>
<p>å¦ä¸€ä¸ªé‡ç‚¹æ˜¯ï¼Œå³ä½¿æˆ‘ä»¬åªéœ€è¦æ¨¡å‹å®Œæˆä»»åŠ¡Aï¼Œå¯èƒ½åœ¨åŠ å…¥è¾…åŠ©ä»»åŠ¡Bä¹‹åå¾—åˆ°å¯¹äºä»»åŠ¡Açš„æ›´å¥½çš„å­¦ä¹ ã€‚ä½†æ˜¯å¦‚ä½•é€‰æ‹©ä»»åŠ¡Bæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬å‡è®¾è¾…åŠ©ä»»åŠ¡åº”è¯¥ä»¥æŸç§æ–¹å¼ä¸ä¸»ä»»åŠ¡ç›¸å…³æˆ–æœ‰åŠ©äºé¢„æµ‹ä¸»ä»»åŠ¡ã€‚ä½†æ˜¯å¦‚ä½•å®šä¹‰è¿™æ ·çš„ç›¸å…³æ€§ä»ç„¶æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸€æ–¹é¢è¿˜æœ‰å¾…æ¢ç´¢ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å†³ç­–æ ‘å­¦ä¹ ]]></title>
        <id>https://txSangyj.github.io/post/å†³ç­–æ ‘å­¦ä¹ /</id>
        <link href="https://txSangyj.github.io/post/å†³ç­–æ ‘å­¦ä¹ /">
        </link>
        <updated>2018-09-06T03:07:49.000Z</updated>
        <summary type="html"><![CDATA[<p><br>
ä¸€ç›´ä»¥æ¥å­¦ä¹ çš„æ–¹å‘ä¾§é‡äºæ·±åº¦å­¦ä¹ æ–¹é¢ï¼Œçœ‹é¢è¯•é¢˜å‘ç°ç¼ºå°‘å†³ç­–æ ‘æ–¹é¢çš„çŸ¥è¯†ï¼Œè¡¥å……å­¦ä¹ ä¸‹ï¼Œå¤§éƒ¨åˆ†å†…å®¹æ¥è‡ªå‘¨å¿—åçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p><ul class="markdownIt-TOC">
<li><a href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">åŸºæœ¬æ¦‚å¿µ</a></li>
<li><a href="#%E5%88%92%E5%88%86%E4%BE%9D%E6%8D%AE">åˆ’åˆ†ä¾æ®</a>
<ul>
<li><a href="#%E4%BF%A1%E6%81%AF%E5%A2%9E%E7%9B%8Aid3">ä¿¡æ¯å¢ç›Šï¼ˆID3ï¼‰</a></li>
<li><a href="#%E5%A2%9E%E7%9B%8A%E7%8E%87c45">å¢ç›Šç‡ï¼ˆC4.5ï¼‰</a></li>
<li><a href="#gini%E6%8C%87%E6%95%B0cart">GiniæŒ‡æ•°ï¼ˆCARTï¼‰</a></li>
</ul>
</li>
<li><a href="#%E5%85%B6%E4%BB%96%E5%A4%84%E7%90%86">å…¶ä»–å¤„ç†</a>
<ul>
<li><a href="#%E5%89%AA%E6%9E%9D">å‰ªæ</a></li>
<li><a href="#%E8%BF%9E%E7%BB%AD%E5%80%BC%E5%92%8C%E7%BC%BA%E5%A4%B1%E5%80%BC">è¿ç»­å€¼å’Œç¼ºå¤±å€¼</a></li>
</ul>
</li>
<li><a href="#%E4%BB%A3%E7%A0%81">ä»£ç </a></li>
</ul>
<br>
ä¸€ç›´ä»¥æ¥å­¦ä¹ çš„æ–¹å‘ä¾§é‡äºæ·±åº¦å­¦ä¹ æ–¹é¢ï¼Œçœ‹é¢è¯•é¢˜å‘ç°ç¼ºå°‘å†³ç­–æ ‘æ–¹é¢çš„çŸ¥è¯†ï¼Œè¡¥å……å­¦ä¹ ä¸‹ï¼Œå¤§éƒ¨åˆ†å†…å®¹æ¥è‡ªå‘¨å¿—åçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ã€‚</p>
<!-- more -->
<h1 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h1>
<p>å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯åŸºäºæ ‘çš„ç»“æ„æ¥è¿›è¡Œå†³ç­–çš„ï¼Œæ ‘çš„å¶èŠ‚ç‚¹å¯¹æ•°æ®ç‚¹çš„åˆ¤å®šç»“æœï¼›å†…éƒ¨èŠ‚ç‚¹å¯¹åº”äºå¯¹å±æ€§çš„æŸç§æµ‹è¯•ï¼ˆå–æŸå€¼ã€å¤§äºå°äºã€çº¿æ€§ç»„åˆååˆ¤å®šã€åˆ†å‰²è¿ç»­å€¼ï¼‰ã€‚æ ·æœ¬ç‚¹æ ¹æ®èŠ‚ç‚¹çš„æµ‹è¯•ç»“æœè¢«åˆ†åˆ°ä¸åŒçš„å­èŠ‚ç‚¹ï¼Œé€’å½’åœ°åˆ’åˆ†åˆ°å¶èŠ‚ç‚¹ã€‚</p>
<p>å†³ç­–æ ‘å­¦ä¹ çš„ç›®çš„æ˜¯äº§ç”Ÿä¸€æ£µæ³›åŒ–èƒ½åŠ›è¾ƒå¼ºçš„å†³ç­–æ ‘ã€‚</p>
<p><code>å¼ºè°ƒæ³›åŒ–èƒ½åŠ›å¼ºï¼Œæ˜¯å› ä¸ºåœ¨ä¸å«ç‰¹å¾å‘é‡ç›¸åŒè€Œæ ‡è®°ä¸åŒï¼ˆå†²çªæ•°æ®ï¼‰è€Œåˆä¸è¿›è¡Œå‰ªæå¤„ç†æ—¶ï¼Œå†³ç­–æ ‘æ€»èƒ½å®Œå…¨æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚æœ€å·®æ¡ä»¶ä¸‹ï¼Œæ¯ä¸ªæ ·æœ¬åˆ†åˆ°ä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œæ³›åŒ–æ€§èƒ½å·®ã€‚</code></p>
<h1 id="åˆ’åˆ†ä¾æ®">åˆ’åˆ†ä¾æ®</h1>
<p>ä»åŸºæœ¬æ¦‚å¿µä¸­å¯ä»¥çœ‹å‡ºï¼Œå†³ç­–æ ‘å¸Œæœ›åˆ†æ”¯èŠ‚ç‚¹çš„åŒç±»æ¯”ä¾‹æ›´é«˜ã€‚äºæ˜¯å¼•å…¥ä¿¡æ¯ç†µæ¥åº¦é‡æ ·æœ¬é›†çš„â€œçº¯åº¦â€ã€‚</p>
<p>ä¿¡æ¯ç†µçš„å®šä¹‰ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>n</mi><mi>t</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>=</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>y</mi><mi mathvariant="normal">âˆ£</mi></mrow></munderover><msub><mi>p</mi><mi>k</mi></msub><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><msub><mi>p</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Ent(D)=-\sum\limits_{k=1}^{|y|}p_klog_2p_k
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2631180000000004em;vertical-align:-1.302113em;"></span><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.961005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mtight">âˆ£</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>y</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">|y|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">âˆ£</span></span></span></span>ä¸ºç±»åˆ«æ•°ï¼Œæ ·æœ¬é›†åˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>ä¸­ç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>ç±»æ ·æœ¬æ‰€å æ¯”ä¾‹ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">p_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚ä»¥æ ·æœ¬é›†åˆçš„æ¯”ä¾‹ä»£æ›¿å®é™…æ•°æ®å‡ºç°çš„æ¦‚ç‡ï¼Œä¿¡æ¯ç†µè¶Šä½ï¼Œåˆ™åˆ†ç±»ç¡®å®šæ€§æ›´é«˜ï¼Œæ ·æœ¬é›†åˆçš„â€œçº¯åº¦â€è¶Šé«˜ã€‚</p>
<h2 id="ä¿¡æ¯å¢ç›Šid3">ä¿¡æ¯å¢ç›Šï¼ˆID3ï¼‰</h2>
<p>æœ‰äº†ä¿¡æ¯ç†µï¼Œè€ƒè™‘åˆ†æ”¯èŠ‚ç‚¹çš„æ ·æœ¬æ•°ä¸åŒï¼Œä¸ºåˆ†æ”¯èŠ‚ç‚¹èµ‹äºˆä¿¡æ¯æƒé‡ï¼ˆå³åˆ†æ”¯èŠ‚ç‚¹æ ·æœ¬æ•°ä¸é›†åˆæ ·æœ¬æ•°ä¹‹æ¯”ï¼‰ï¼Œå¾—åˆ°ä¸€æ¬¡èŠ‚ç‚¹åˆ’åˆ†çš„ä¿¡æ¯å¢ç›Šï¼Œå…¬å¼å®šä¹‰ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>E</mi><mi>n</mi><mi>t</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><mfrac><mrow><mi mathvariant="normal">âˆ£</mi><msup><mi>D</mi><mi>v</mi></msup><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>D</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac><mi>E</mi><mi>n</mi><mi>t</mi><mo>(</mo><msup><mi>D</mi><mi>v</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">Gain(D,a)=Ent(D)-\sum\limits_{v=1}^{V}\frac{|D^v|}{|D|}Ent(D^v)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mord">âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>ä¸ºæ ·æœ¬æ•°æ®é›†çš„æŸä¸ªå±æ€§ï¼Œå¯¹äºç¦»æ•£å€¼å¯ä»¥å¯¹æ¯ä¸ªå±æ€§åˆ†åˆ«è®¡ç®—ä¿¡æ¯å¢ç›Šï¼Œæ ¹æ®<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mo>âˆ—</mo></msub><mo>=</mo><msub><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mrow><mi>a</mi><mo>âˆˆ</mo><mi>A</mi></mrow></msub><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">a_*=\underset{a\in A}{argmax}Gain(D,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.175696em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">âˆ—</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.716141em;vertical-align:-0.966141em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.161229em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">âˆˆ</span><span class="mord mathdefault mtight">A</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.966141em;"><span></span></span></span></span></span></span><span class="mord mathdefault">G</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>ï¼Œå¾—åˆ°æœ€ä¼˜åˆ’åˆ†å±æ€§ã€‚</p>
<h2 id="å¢ç›Šç‡c45">å¢ç›Šç‡ï¼ˆC4.5ï¼‰</h2>
<p>ä»¥ä¿¡æ¯å¢ç›Šä¸ºåˆ’åˆ†ä¾æ®æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šä¿¡æ¯å¢ç›Šå‡†ä¾§ç½ªåŸŸå¯å–å€¼æ•°ç›®è¾ƒå¤šçš„å±æ€§æœ‰åå¥½ï¼ˆåˆ’åˆ†åå¾—åˆ°æ›´å¤šçš„å­èŠ‚ç‚¹ï¼Œçº¯åº¦è¾ƒé«˜ï¼‰ã€‚å¯¹æ ·æœ¬é›†çš„å±æ€§<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>ï¼Œå¼•å…¥å±æ€§çš„å›ºæœ‰å€¼ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>V</mi><mo>(</mo><mi>a</mi><mo>)</mo><mo>=</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><mfrac><mrow><mi mathvariant="normal">âˆ£</mi><msup><mi>D</mi><mi>v</mi></msup><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>D</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mfrac><mrow><mi mathvariant="normal">âˆ£</mi><msup><mi>D</mi><mi>v</mi></msup><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>D</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">IV(a)=-\sum\limits_{v=1}^{V}\frac{|D^v|}{|D|}log_2\frac{|D^v|}{|D|}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mord">âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mord">âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>ä½¿ç”¨å›ºæœ‰å€¼å’Œä¿¡æ¯å¢ç›Šå®šä¹‰å¢ç›Šç‡ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><msub><mspace linebreak="newline"></mspace><mi>r</mi></msub><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><mrow><mi>I</mi><mi>V</mi><mo>(</mo><mi>a</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">Gain\\_ratio(D,a)=\frac{Gain(D,a)}{IV(a)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mspace newline"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>å¢ç›Šç‡å‡†åˆ™ä¸ä¿¡æ¯å¢ç›Šå‡†åˆ™ç›¸åï¼Œå€¾å‘äºé€‰æ‹©å¯å–å€¼æ•°ç›®å°‘çš„å±æ€§ä½œä¸ºåˆ’åˆ†ä¾æ®ï¼ˆaçš„å–å€¼è¶Šå°‘ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>V</mi><mo>(</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">IV(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>è¶Šå°ï¼Œå¢ç›Šç‡è¶Šå¤§ï¼‰ã€‚</p>
<h2 id="giniæŒ‡æ•°cart">GiniæŒ‡æ•°ï¼ˆCARTï¼‰</h2>
<p>ä½¿ç”¨Giniå€¼æ¥åº¦é‡æ•°æ®é›†çš„â€œçº¯åº¦â€ï¼ŒGiniå€¼è¶Šå°çº¯åº¦è¶Šé«˜ã€‚å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>y</mi><mi mathvariant="normal">âˆ£</mi></mrow></munderover><munder><mo>âˆ‘</mo><mrow><msup><mi>k</mi><mo mathvariant="normal">â€²</mo></msup><mi mathvariant="normal">â‰ </mi><mi>k</mi></mrow></munder><msub><mi>p</mi><mi>k</mi></msub><msub><mi>p</mi><msup><mi>k</mi><mo mathvariant="normal">â€²</mo></msup></msub><mo>=</mo><mn>1</mn><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>y</mi><mi mathvariant="normal">âˆ£</mi></mrow></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">Gini(D)=\sum\limits_{k=1}^{|y|}\sum\limits_{k&#x27;\neq k}p_kp_{k&#x27;}=1-\sum\limits_{k=1}^{|y|}p_k^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.399226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.961005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mtight">âˆ£</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight">î€ </span></span><span class="fix"></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2631180000000004em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.961005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mtight">âˆ£</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>GiniæŒ‡æ•°çš„å®šä¹‰ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><mfrac><mrow><mi mathvariant="normal">âˆ£</mi><msup><mi>D</mi><mi>v</mi></msup><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>D</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo>(</mo><msup><mi>D</mi><mi>v</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">Gini\_index(D,a)=\sum\limits_{v=1}^{V}\frac{|D^v|}{|D|}Gini(D^v)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mord">âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">G</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<h1 id="å…¶ä»–å¤„ç†">å…¶ä»–å¤„ç†</h1>
<h2 id="å‰ªæ">å‰ªæ</h2>
<p>å‰ªææ˜¯ä¸ºäº†é¿å…å†³ç­–æ ‘åˆ†æ”¯è¿‡å¤šï¼Œé¿å…è¿‡æ‹Ÿåˆç°è±¡ã€‚ä¸»è¦åˆ†<strong>é¢„å‰ªæ</strong>å’Œ<strong>åå‰ªæ</strong>ã€‚</p>
<p>ä¸¤è€…çš„ç›¸åŒç‚¹æ˜¯éƒ½ç”¨éªŒè¯é›†å¯¹åˆ’åˆ†èŠ‚ç‚¹çš„æ³›åŒ–æ€§èƒ½è¿›è¡Œä¼°è®¡ï¼Œä¸åŒç‚¹åœ¨äºé¢„å‰ªæåœ¨æ¯ä¸ªèŠ‚ç‚¹åˆ’åˆ†å‰è¿›è¡Œä¼°è®¡ï¼Œåå‰ªæåœ¨å†³ç­–æ ‘è®­ç»ƒå®Œæˆåè‡ªåº•å‘ä¸Šåœ°ä¼°è®¡æ¯ä¸ªåˆ’åˆ†èŠ‚ç‚¹ã€‚</p>
<p>ä¸¤ç§æ–¹å¼éƒ½èƒ½é™ä½è¿‡æ‹Ÿåˆé£é™©ï¼Œé¢„å‰ªæè¿˜èƒ½é™ä½è®­ç»ƒæ—¶é—´ï¼Œä½†ç”±äºå…¶è´ªå¿ƒæ€§å¯èƒ½å¸¦æ¥æ¬ æ‹Ÿåˆé£é™©ï¼›åå‰ªæè®­ç»ƒæ—¶é—´é•¿ï¼Œä½†ä¿ç•™åˆ†æ”¯æ›´å¤šï¼Œæ€§èƒ½ä¼˜äºé¢„å‰ªæã€‚</p>
<h2 id="è¿ç»­å€¼å’Œç¼ºå¤±å€¼">è¿ç»­å€¼å’Œç¼ºå¤±å€¼</h2>
<p><strong>è¿ç»­å€¼</strong><br>
å¯¹äºè¿ç»­å€¼çš„å¤„ç†å¯ä»¥é‡‡ç”¨ç¦»æ•£åŒ–ï¼Œå¯¹å–å€¼æŒ‰ä»å°åˆ°å¤§æ’åºï¼Œä¾æ¬¡å–ç›¸é‚»å€¼çš„å‡å€¼ä¸ºåˆ’åˆ†ç‚¹ï¼Œå¾—åˆ°å€™é€‰çš„åˆ’åˆ†ç‚¹é›†åˆï¼Œç„¶åé€‰æ‹©ä½¿å¢ç›Šæœ€å¤§åŒ–çš„åˆ’åˆ†ç‚¹ã€‚</p>
<p><strong>ç¼ºå¤±å€¼</strong><br>
å¯¹äºç¼ºå¤±å€¼çš„å¤„ç†æ˜¯å†³ç­–æ ‘ç®—æ³•çš„ä¼˜åŠ¿ï¼Œå±æ€§å€¼ç¼ºå¤±äº§ç”Ÿä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>å¦‚ä½•é€‰æ‹©åˆ’åˆ†å±æ€§ï¼›</li>
<li>å¦‚ä½•å¯¹ç¼ºå¤±å½“å‰åˆ’åˆ†å±æ€§çš„æ ·æœ¬è¿›è¡Œåˆ’åˆ†ã€‚<br>
å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åœ¨å±æ€§ä¸Šæ²¡æœ‰ç¼ºå¤±çš„æ ·æœ¬é›†è¿›è¡Œåˆ¤æ–­ã€‚ä¸ºæ ·æœ¬èµ‹äºˆæƒé‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">w_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>D</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">~</span></span></span></span></span></span></span></span></span>è¡¨ç¤ºæ²¡æœ‰ç¼ºå¤±å€¼çš„æ ·æœ¬é›†ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï</span></span></span></span>è¡¨ç¤ºæ— ç¼ºå¤±å€¼æ ·æœ¬æ‰€å æ¯”ä¾‹ï¼ˆå…¶å®æ˜¯æ ·æœ¬æƒå€¼æ‰€å æ¯”ä¾‹ï¼‰ï¼Œå¯¹äºä¿¡æ¯å¢ç›Šæ¥è¯´ï¼Œæ¨å¹¿åçš„å¼å­ä¸ºï¼š</li>
</ol>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>Ï</mi><mo>Ã—</mo><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>(</mo><mover accent="true"><mi>D</mi><mo>~</mo></mover><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Gain(D,a)=\rhoÃ—Gain(\tilde{D},a)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1701899999999998em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">~</span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span></p>
<p>å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œè‹¥æ ·æœ¬åœ¨åˆ’åˆ†å±æ€§ä¸Šå–å€¼æœªçŸ¥ï¼Œ<strong>å°†æ ·æœ¬åŒæ—¶åˆ’åˆ†åˆ°æ‰€æœ‰å­èŠ‚ç‚¹</strong>ï¼Œå¹¶è°ƒæ•´æ ·æœ¬æƒå€¼ã€‚</p>
<p><code>ä»£ç éƒ¨åˆ†çš„é—®é¢˜ï¼š1ã€è¿ç»­å±æ€§åˆ†å‰²æ²¡åšï¼›2ã€ä¿¡æ¯å¢ç›Šè®¡ç®—å†™çš„æœ‰ç‚¹ä¹±ã€‚</code></p>
<h1 id="ä»£ç ">ä»£ç </h1>
<p><strong>æ•°æ®é›†</strong></p>
<pre><code>ç¼–å·	è‰²æ³½	æ ¹è’‚	æ•²å£°	çº¹ç†	è„éƒ¨	è§¦æ„Ÿ	å¯†åº¦	å«ç³–ç‡	å¥½ç“œ
1	é’ç»¿	èœ·ç¼©	æµŠå“	æ¸…æ™°	å‡¹é™·	ç¡¬æ»‘	0.697	0.460	æ˜¯
2	ä¹Œé»‘	èœ·ç¼©	æ²‰é—·	æ¸…æ™°	å‡¹é™·	ç¡¬æ»‘	0.774	0.376	æ˜¯
3	ä¹Œé»‘	èœ·ç¼©	æµŠå“	æ¸…æ™°	å‡¹é™·	ç¡¬æ»‘	0.634	0.264	æ˜¯
4	é’ç»¿	èœ·ç¼©	æ²‰é—·	æ¸…æ™°	å‡¹é™·	ç¡¬æ»‘	0.608	0.318	æ˜¯
5	æµ…ç™½	èœ·ç¼©	æµŠå“	æ¸…æ™°	å‡¹é™·	ç¡¬æ»‘	0.556	0.215	æ˜¯
6	é’ç»¿	ç¨èœ·	æµŠå“	æ¸…æ™°	ç¨å‡¹	è½¯ç²˜	0.403	0.237	æ˜¯
7	ä¹Œé»‘	ç¨èœ·	æµŠå“	ç¨ç³Š	ç¨å‡¹	è½¯ç²˜	0.481	0.149	æ˜¯
8	ä¹Œé»‘	ç¨èœ·	æµŠå“	æ¸…æ™°	ç¨å‡¹	ç¡¬æ»‘	0.437	0.211	æ˜¯
9	ä¹Œé»‘	ç¨èœ·	æ²‰é—·	ç¨ç³Š	ç¨å‡¹	ç¡¬æ»‘	0.666	0.091	å¦
10	é’ç»¿	ç¡¬æŒº	æ¸…è„†	æ¸…æ™°	å¹³å¦	è½¯ç²˜	0.243	0.267	å¦
11	æµ…ç™½	ç¡¬æŒº	æ¸…è„†	æ¨¡ç³Š	å¹³å¦	ç¡¬æ»‘	0.245	0.057	å¦
12	æµ…ç™½	èœ·ç¼©	æµŠå“	æ¨¡ç³Š	å¹³å¦	è½¯ç²˜	0.343	0.099	å¦
13	é’ç»¿	ç¨èœ·	æµŠå“	ç¨ç³Š	å‡¹é™·	ç¡¬æ»‘	0.639	0.161	å¦
14	æµ…ç™½	ç¨èœ·	æ²‰é—·	ç¨ç³Š	å‡¹é™·	ç¡¬æ»‘	0.657	0.198	å¦
15	ä¹Œé»‘	ç¨èœ·	æµŠå“	æ¸…æ™°	ç¨å‡¹	è½¯ç²˜	0.360	0.370	å¦
16	æµ…ç™½	èœ·ç¼©	æµŠå“	æ¨¡ç³Š	å¹³å¦	ç¡¬æ»‘	0.593	0.042	å¦
17	é’ç»¿	èœ·ç¼©	æ²‰é—·	ç¨ç³Š	ç¨å‡¹	ç¡¬æ»‘	0.719	0.103	å¦
</code></pre>
<pre><code class="language-python">import numpy as np
import pandas as pd
Data = pd.DataFrame.from_csv('./watermelon3_0_En.csv')
X = Data.values[:,0:6]
Y = Data.values[:,-1]
class Node(object):

    def __init__(self,data,labels,attributes=None):
        &quot;&quot;&quot;
        train_X
            type:np.ndarray()
            size:(n_samples,n_features)
        
        train_Y
            type:np.ndarray()
            size:(n_samples,)
        &quot;&quot;&quot;
        self.data = data
        self.label = labels
        self.attribute_type = None
        
        self.classes = set(labels)
        self.subnodes = list()
        
        self.leaf = False
        self.y_hat = None
        self.splite_attribute = None
        
        if attributes == None:
            self.attributes = list(range(self.data.shape[1]))
        else:
            self.attributes = attributes

    def GetMajority(self):
        &quot;&quot;&quot;
        find most common label for a dataset
        &quot;&quot;&quot;
        y_ = list(node.labels)
        return max(y_,key=y_.count)
       
        
class DecisionTree(object):
    
    def __init__(self,train_X,train_Y):
        self.root = Node(data=train_X,labels=train_Y)
        self.GenrateTree()
    
    def Ent(self,P_k):
        &quot;&quot;&quot;
        Compute entropy.
        &quot;&quot;&quot;
        P_k = np.array(P_k)
        P_k[P_k==0] = 1
        return -np.sum(P_k*np.log2(P_k))


    def GetGain(self,node):
        &quot;&quot;&quot;
        Compute information gain and gain ratio
        return (gain,gain_ratio)
        &quot;&quot;&quot;
        d_p_k =  [sum(node.label==x)/len(node.label) for x in node.classes]
        ent_d = self.Ent(d_p_k) #compute entropy of dataset D
        gain = list()
        gain_ratio = list()

        for attribute in node.attributes:
            if attribute is not None:
                d_p_v = list()
                ent_d_v = 0.0
                attribute_values = node.data[:,attribute]
                attribute_list = list(set(attribute_values))

                weight_d_v = [sum(attribute_values==x)/len(attribute_values) for x in attribute_list]
                for i,v in enumerate(attribute_list):
                    d_n = node.label[node.data[:,attribute] == v]
                    d_p_k = [sum(d_n==x)/len(d_n) for x in node.classes]

                    ent_d_v += weight_d_v[i] *self.Ent(d_p_k)
                    d_p_v.append(len(d_n)/len(node.label))

                gain.append(ent_d-ent_d_v)
                intrinsic_value = self.Ent(d_p_v)
                gain_ratio.append(np.divide(gain[attribute],intrinsic_value))
            else:
                gain.append(0)
                gain_ratio.append(0)
        return gain,gain_ratio
    
    def GenrateNodes(self,node):
        &quot;&quot;&quot;
        Genrate sub-nodes for a given node.
        &quot;&quot;&quot;
        (_,gain_ratio) = self.GetGain(node)
        node.splite_attribute = gain_ratio.index(np.max(gain_ratio))
        attribute_values = node.data[:,node.splite_attribute]
        attribute_list = set(attribute_values)
        subattributes = node.attributes.copy()
        subattributes[node.splite_attribute]=None
        for attr in attribute_list:
            index = (attribute_values == attr)
            subnode = Node(data=node.data[index,:],labels=node.label[index],
                           attributes=subattributes)
            node.subnodes.append(subnode)
        return node.subnodes
    
    def GenrateTree(self):
        &quot;&quot;&quot;
        Genrate decision tree from root.
        &quot;&quot;&quot;
        q = list()
        node = self.root
        
        while(len(q)&gt;0 or node!= None):
            if len(node.classes) == 1:#Data belongs to the same class
                node.y_hat = node.classes
                node.leaf = True
            elif len(node.attributes) == 0:# or len(set(node.data[:,attribute]))==1:
                node.y_hat = node.GetMajority()
                node.leaf = True
            else:
                q.extend(self.GenrateNodes(node))
            if len(q) == 0:
                return
            node = q.pop(0)
    def Summary(self):
        &quot;&quot;&quot;
        Prints a string summary of the decision tree.
        &quot;&quot;&quot;
        q = list()
        node = self.root
        q.append(node)
        
        while(q):
            node = q.pop(0)
            print('splite_attribute',node.splite_attribute)
            print('data',node.data)
            print('Y_hat',node.y_hat)
            print('===='*20)
            q.extend(node.subnodes)
tree = DecisionTree(train_X=X,train_Y=Y)
tree.Summary()
</code></pre>
]]></content>
    </entry>
</feed>